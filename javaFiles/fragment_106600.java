public class ClassMap<V> extends HashMap<Class<?>, V> {
    @Override
    public V get(Object key) {
        //use the logic you mentioned in your question here, with super.get(key)
    }
}