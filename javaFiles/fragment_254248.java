try {
   // set up standard message
   try {
     // perform attachment
   }
   catch {
     // perhaps amend your original message to indicate attachment failed
   }
   send();
}
catch {
  // handle a complete failure here...
}